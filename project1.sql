-- ЧАСТЬ ПЕРВАЯ. Простые запросы + Агрегации

-- Создадим новую базу Школа
CREATE DATABASE School;

-- Подключимся к ней
\c Школа

-- Создадим новые таблицы для базы School
-- Таблица Учителя
CREATE TABLE teachers (
    teacher_id SERIAL PRIMARY KEY,
    first_name VARCHAR(50),
    father_name VARCHAR(50),
    last_name VARCHAR(50)
);

-- Таблица Классы
CREATE TABLE classes (
    class_id SERIAL PRIMARY KEY,
    class_number INT,
    class_letter CHAR(1),
    teacher_id INT,
    FOREIGN KEY (teacher_id) REFERENCES teachers(teacher_id)
);

-- Таблица Ученики
CREATE TABLE students (
    student_id SERIAL PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    date_of_birth DATE,
    class_id INT,
    FOREIGN KEY (class_id) REFERENCES classes(class_id)
);

-- Таблица Предметы
CREATE TABLE subjects (
    subject_id SERIAL PRIMARY KEY,
    subject_name VARCHAR(50)
);

CREATE TABLE teacher_subjects (
    teacher_subject_id SERIAL PRIMARY KEY,
    teacher_id INT,
    subject_id INT,
    FOREIGN KEY (teacher_id) REFERENCES teachers(teacher_id),
    FOREIGN KEY (subject_id) REFERENCES subjects(subject_id)
);

CREATE TABLE student_grades (
    grade_id SERIAL PRIMARY KEY,
    student_id INT,
    teacher_subject_id INT,
    date DATE,
    grade INT,
    comment TEXT,
    FOREIGN KEY (student_id) REFERENCES students(student_id),
    FOREIGN KEY (teacher_subject_id) REFERENCES teacher_subjects(teacher_subject_id)
);

CREATE TABLE homework (
    homework_id SERIAL PRIMARY KEY,
    class_id INT,
    teacher_subject_id INT,
    due_date DATE,
    description TEXT,
    FOREIGN KEY (class_id) REFERENCES classes(class_id),
    FOREIGN KEY (teacher_subject_id) REFERENCES teacher_subjects(teacher_subject_id)
);

CREATE TABLE quarter_grades (
    quarter_grade_id SERIAL PRIMARY KEY,
    student_id INT,
    teacher_subject_id INT,
    quarter INT,
    grade INT,
    FOREIGN KEY (student_id) REFERENCES students(student_id),
    FOREIGN KEY (teacher_subject_id) REFERENCES teacher_subjects(teacher_subject_id)
);

-- Заполним созданные таблицы
-- Заполним классы
INSERT INTO classes (class_number, class_letter, teacher_id)
VALUES
(8, 'A', 7),
(8, 'B', 8),
(8, 'C', 9),
(8, 'D', 10),
(9, 'A', 1),
(9, 'B', 2),
(9, 'C', 3),
(9, 'D', 4),
(10, 'A', 5),
(11, 'A', 6);

-- Заполним школьные предметы
INSERT INTO subjects (subject_name)
VALUES
('Русский язык'),
('Математика'),
('Литература'),
('Английский язык'),
('Физика'),
('Химия'),
('Информатика'),
('География'),
('История'),
('Обществознание');

-- Заполним учителей школы
INSERT INTO teachers (first_name, father_name, last_name)
VALUES
('Алексей', 'Иванович', 'Смирнов'),
('Ирина', 'Петровна', 'Кузнецова'),
('Владимир', 'Сергеевич', 'Петров'),
('Ольга', 'Васильевна', 'Соколова'),
('Наталья', 'Александровна', 'Попова'),
('Екатерина', 'Николаевна', 'Морозова'),
('Дмитрий', 'Викторович', 'Иванов'),
('Марина', 'Андреевна', 'Лебедева'),
('Сергей', 'Михайлович', 'Кузьмин'),
('Анна', 'Александровна', 'Новикова'),
('Татьяна', 'Юрьевна', 'Федорова'),
('Игорь', 'Алексеевич', 'Семенов'),
('Людмила', 'Владимировна', 'Орлова'),
('Андрей', 'Борисович', 'Михайлов'),
('Елена', 'Геннадьевна', 'Сафонова'),
('Павел', 'Владимирович', 'Воробьев'),
('Юлия', 'Павловна', 'Зайцева'),
('Артур', 'Евгеньевич', 'Климов'),
('Виктория', 'Игоревна', 'Беляева'),
('Михаил', 'Сергеевич', 'Гусев');

-- Заполним какие предметы преподают учителя
INSERT INTO teacher_subjects (teacher_id, subject_id)
VALUES
(1, 1),  -- Алексей Иванович Смирнов преподает Русский язык
(2, 2),  -- Ирина Петровна Кузнецова преподает Математику
(3, 3),  -- Владимир Сергеевич Петров преподает Литературу
(4, 4),  -- Ольга Васильевна Соколова преподает Английский язык
(5, 5),  -- Наталья Александровна Попова преподает Физику
(6, 6),  -- Екатерина Николаевна Морозова преподает Химию
(7, 7),  -- Дмитрий Викторович Иванов преподает Информатику
(8, 8),  -- Марина Андреевна Лебедева преподает Географию
(9, 9),  -- Сергей Михайлович Кузьмин преподает Историю
(10, 10), -- Анна Александровна Новикова преподает Обществознание
(11, 1),  -- Татьяна Юрьевна Федорова преподает Русский язык
(12, 2),  -- Игорь Алексеевич Семенов преподает Математику
(13, 3),  -- Людмила Владимировна Орлова преподает Литературу
(14, 4),  -- Андрей Борисович Михайлов преподает Английский язык
(15, 5),  -- Елена Геннадьевна Сафонова преподает Физику
(16, 6),  -- Павел Владимирович Воробьев преподает Химию
(17, 7),  -- Юлия Павловна Зайцева преподает Информатику
(18, 8),  -- Артур Евгеньевич Климов преподает Географию
(19, 9),  -- Виктория Игоревна Беляева преподает Историю
(20, 10); -- Михаил Сергеевич Гусев преподает Обществознание

-- Ученики для 8A класса
INSERT INTO students (first_name, last_name, date_of_birth, class_id)
VALUES
('Андрей', 'Васильев', '2009-01-15', 1),
('Борис', 'Демидов', '2009-02-20', 1),
('Вера', 'Смирнова', '2009-03-10', 1),
('Андрей', 'Васильев', '2009-01-15', 1),
('Борис', 'Демидов', '2009-02-20', 1),
('Вера', 'Смирнова', '2009-03-10', 1),
('Глеб', 'Куликов', '2009-04-01', 1),
('Денис', 'Филиппов', '2009-05-23', 1),
('Евгений', 'Соболев', '2009-06-13', 1),
('Жанна', 'Тимофеева', '2009-07-07', 1),
('Зоя', 'Никитина', '2009-08-15', 1),
('Игорь', 'Михайлов', '2009-09-05', 1),
('Кирилл', 'Романов', '2009-10-25', 1),
('Лариса', 'Осипова', '2009-11-12', 1),
('Мария', 'Белова', '2009-12-19', 1),
('Наталья', 'Герасимова', '2009-01-28', 1),
('Олег', 'Фомин', '2009-02-14', 1),
('Павел', 'Давыдов', '2009-03-21', 1),
('Роман', 'Тихонов', '2009-04-10', 1),
('Светлана', 'Савельева', '2009-05-08', 1),
('Татьяна', 'Морозова', '2009-06-17', 1),
('Ульяна', 'Максимова', '2009-07-24', 1),
('Филипп', 'Тихомиров', '2009-08-29', 1);

-- Ученики для 8Б класса
INSERT INTO students (first_name, last_name, date_of_birth, class_id)
VALUES
('Галина', 'Иванова', '2009-04-05', 2),
('Дмитрий', 'Кузнецов', '2009-05-11', 2),
('Екатерина', 'Морозова', '2009-06-15', 2),
('Захар', 'Попов', '2009-07-03', 2),
('Ирина', 'Соколов', '2009-08-07', 2),
('Константин', 'Алексеев', '2009-09-18', 2),
('Людмила', 'Иванова', '2009-10-21', 2),
('Михаил', 'Николаев', '2009-11-27', 2),
('Николай', 'Петров', '2009-12-13', 2),
('Ольга', 'Кузьмина', '2009-01-20', 2),
('Петр', 'Сидоров', '2009-02-16', 2),
('Роман', 'Смирнов', '2009-03-14', 2),
('Светлана', 'Соколова', '2009-04-26', 2),
('Татьяна', 'Федорова', '2009-05-30', 2),
('Ульяна', 'Михайлова', '2009-06-22', 2),
('Федор', 'Новиков', '2009-07-09', 2),
('Христина', 'Макарова', '2009-08-14', 2),
('Цезарь', 'Лебедев', '2009-09-23', 2),
('Чулпан', 'Волкова', '2009-10-10', 2),
('Шамиль', 'Леонов', '2009-11-05', 2);

-- Ученики для 8В класса
INSERT INTO students (first_name, last_name, date_of_birth, class_id)
VALUES
('Жанна', 'Попова', '2009-07-07', 3),
('Захар', 'Николаев', '2009-08-19', 3),
('Ирина', 'Лебедева', '2009-09-30', 3),
('Кирилл', 'Орлов', '2009-10-22', 3),
('Лидия', 'Петрова', '2009-11-05', 3),
('Михаил', 'Соколов', '2009-12-14', 3),
('Наталья', 'Федорова', '2009-01-15', 3),
('Олег', 'Семенов', '2009-02-20', 3),
('Павел', 'Новиков', '2009-03-10', 3),
('Роман', 'Климов', '2009-04-05', 3),
('Светлана', 'Беляева', '2009-05-11', 3),
('Татьяна', 'Гусева', '2009-06-15', 3),
('Ульяна', 'Михайлова', '2009-07-07', 3),
('Филипп', 'Воробьев', '2009-08-19', 3),
('Христина', 'Зайцева', '2009-09-30', 3),
('Цезарь', 'Григорьев', '2009-10-22', 3),
('Чулпан', 'Фролова', '2009-11-05', 3),
('Шамиль', 'Александров', '2009-12-14', 3),
('Эльвира', 'Яковлева', '2009-01-15', 3),
('Юрий', 'Морозов', '2009-02-20', 3);

-- Ученики для 8Г класса
INSERT INTO students (first_name, last_name, date_of_birth, class_id)
VALUES
('Кирилл', 'Орлов', '2009-10-22', 4),
('Лидия', 'Петрова', '2009-11-05', 4),
('Михаил', 'Соколов', '2009-12-14', 4),
('Наталья', 'Федорова', '2009-01-15', 4),
('Олег', 'Семенов', '2009-02-20', 4),
('Павел', 'Новиков', '2009-03-10', 4),
('Роман', 'Климов', '2009-04-05', 4),
('Светлана', 'Беляева', '2009-05-11', 4),
('Татьяна', 'Гусева', '2009-06-15', 4),
('Ульяна', 'Михайлова', '2009-07-07', 4),
('Филипп', 'Воробьев', '2009-08-19', 4),
('Христина', 'Зайцева', '2009-09-30', 4),
('Цезарь', 'Григорьев', '2009-10-22', 4),
('Чулпан', 'Фролова', '2009-11-05', 4),
('Шамиль', 'Александров', '2009-12-14', 4),
('Эльвира', 'Яковлева', '2009-01-15', 4),
('Юрий', 'Морозов', '2009-02-20', 4),
('Ярослав', 'Денисов', '2009-03-10', 4),
('Анастасия', 'Павлова', '2009-04-15', 4),
('Борис', 'Игнатов', '2009-05-20', 4);

-- Ученики для 9А класса
INSERT INTO students (first_name, last_name, date_of_birth, class_id)
VALUES
('Алексей', 'Воробьев', '2008-01-15', 5),
('Анна', 'Зайцева', '2008-02-20', 5),
('Борис', 'Климов', '2008-03-10', 5),
('Вера', 'Попова', '2008-04-05', 5),
('Глеб', 'Федоров', '2008-05-11', 5),
('Дмитрий', 'Лебедев', '2008-06-15', 5),
('Евгения', 'Новикова', '2008-07-07', 5),
('Жанна', 'Морозова', '2008-08-19', 5),
('Захар', 'Семенов', '2008-09-30', 5),
('Ирина', 'Гусева', '2008-10-22', 5),
('Кирилл', 'Яковлев', '2008-11-05', 5),
('Лидия', 'Денисова', '2008-12-14', 5),
('Михаил', 'Павлов', '2008-01-15', 5),
('Наталья', 'Игнатова', '2008-02-20', 5),
('Олег', 'Макаров', '2008-03-10', 5),
('Павел', 'Смирнов', '2008-04-05', 5),
('Роман', 'Иванов', '2008-05-11', 5),
('Светлана', 'Соколов', '2008-06-15', 5),
('Татьяна', 'Попова', '2008-07-07', 5),
('Ульяна', 'Кузнецова', '2008-08-19', 5);

-- Ученики для 9Б класса
INSERT INTO students (first_name, last_name, date_of_birth, class_id)
VALUES
('Анна', 'Орлова', '2008-01-16', 6),
('Богдан', 'Иванов', '2008-02-21', 6),
('Валентина', 'Петрова', '2008-03-11', 6),
('Глеб', 'Соколов', '2008-04-06', 6),
('Даниил', 'Сидоров', '2008-05-12', 6),
('Екатерина', 'Кузнецова', '2008-06-16', 6),
('Жанна', 'Лебедева', '2008-07-08', 6),
('Иван', 'Новиков', '2008-08-20', 6),
('Ирина', 'Климова', '2008-09-25', 6),
('Константин', 'Федоров', '2008-10-31', 6),
('Людмила', 'Макарова', '2008-11-18', 6),
('Мария', 'Алексеева', '2008-12-24', 6),
('Николай', 'Воробьев', '2008-01-29', 6),
('Ольга', 'Семенова', '2008-02-14', 6),
('Петр', 'Беляев', '2008-03-22', 6),
('Светлана', 'Тимофеева', '2008-04-12', 6),
('Тимур', 'Евдокимов', '2008-05-19', 6),
('Филипп', 'Козлов', '2008-06-30', 6),
('Христина', 'Морозова', '2008-07-24', 6),
('Эдуард', 'Гусев', '2008-08-15', 6);

-- Ученики для 9В класса
INSERT INTO students (first_name, last_name, date_of_birth, class_id)
VALUES
('Андрей', 'Смирнов', '2008-01-10', 7),
('Борис', 'Петров', '2008-02-25', 7),
('Владимир', 'Иванов', '2008-03-30', 7),
('Григорий', 'Соколов', '2008-04-18', 7),
('Даниил', 'Попов', '2008-05-22', 7),
('Екатерина', 'Васильева', '2008-06-12', 7),
('Жанна', 'Кузнецова', '2008-07-08', 7),
('Игорь', 'Михайлов', '2008-08-19', 7),
('Кирилл', 'Новиков', '2008-09-15', 7),
('Людмила', 'Федорова', '2008-10-20', 7),
('Мария', 'Морозова', '2008-11-23', 7),
('Николай', 'Лебедев', '2008-12-30', 7),
('Ольга', 'Семенова', '2008-01-13', 7),
('Павел', 'Павлов', '2008-02-24', 7),
('Роман', 'Макаров', '2008-03-19', 7),
('Светлана', 'Климова', '2008-04-07', 7),
('Татьяна', 'Беляева', '2008-05-15', 7),
('Ульяна', 'Гусева', '2008-06-28', 7),
('Филипп', 'Орлов', '2008-07-21', 7),
('Эльвира', 'Яковлева', '2008-08-13', 7);

-- Ученики для 9Г класса
INSERT INTO students (first_name, last_name, date_of_birth, class_id)
VALUES
('Алексей', 'Тимофеев', '2008-01-10', 8),
('Богдан', 'Евдокимов', '2008-02-25', 8),
('Владимир', 'Козлов', '2008-03-30', 8),
('Георгий', 'Михайлов', '2008-04-18', 8),
('Дмитрий', 'Орлов', '2008-05-22', 8),
('Екатерина', 'Новикова', '2008-06-12', 8),
('Жанна', 'Семенова', '2008-07-08', 8),
('Игорь', 'Гусев', '2008-08-19', 8),
('Константин', 'Яковлев', '2008-09-15', 8),
('Людмила', 'Климова', '2008-10-20', 8),
('Марина', 'Павлова', '2008-11-23', 8),
('Наталья', 'Макарова', '2008-12-30', 8),
('Ольга', 'Лебедева', '2008-01-13', 8),
('Павел', 'Соколов', '2008-02-24', 8),
('Роман', 'Федоров', '2008-03-19', 8),
('Светлана', 'Морозова', '2008-04-07', 8),
('Тимур', 'Беляев', '2008-05-15', 8),
('Ульяна', 'Петрова', '2008-06-28', 8),
('Филипп', 'Воробьев', '2008-07-21', 8),
('Христина', 'Зайцева', '2008-08-13', 8);

-- Ученики для 10А класса
INSERT INTO students (first_name, last_name, date_of_birth, class_id)
VALUES
('Алексей', 'Тимофеев', '2008-01-10', 9),
('Богдан', 'Евдокимов', '2008-02-25', 9),
('Владимир', 'Козлов', '2008-03-30', 9),
('Георгий', 'Михайлов', '2008-04-18', 9),
('Дмитрий', 'Орлов', '2008-05-22', 9),
('Екатерина', 'Новикова', '2008-06-12', 9),
('Жанна', 'Семенова', '2008-07-08', 9),
('Игорь', 'Гусев', '2008-08-19', 9),
('Константин', 'Яковлев', '2008-09-15', 9),
('Людмила', 'Климова', '2008-10-20', 9),
('Марина', 'Павлова', '2008-11-23', 9),
('Наталья', 'Макарова', '2008-12-30', 9),
('Ольга', 'Лебедева', '2008-01-13', 9),
('Павел', 'Соколов', '2008-02-24', 9),
('Роман', 'Федоров', '2008-03-19', 9),
('Светлана', 'Морозова', '2008-04-07', 9),
('Тимур', 'Беляев', '2008-05-15', 9),
('Ульяна', 'Петрова', '2008-06-28', 9),
('Филипп', 'Воробьев', '2008-07-21', 9),
('Христина', 'Зайцева', '2008-08-13', 9);

-- Ученики для 11А класса
INSERT INTO students (first_name, last_name, date_of_birth, class_id)
VALUES
('Анастасия', 'Павлова', '2006-01-15', 10),
('Борис', 'Игнатов', '2006-02-20', 10),
('Владислав', 'Макаров', '2006-03-10', 10),
('Галина', 'Климова', '2006-04-05', 10),
('Денис', 'Смирнов', '2006-05-11', 10),
('Екатерина', 'Новикова', '2006-06-15', 10),
('Жанна', 'Попова', '2006-07-07', 10),
('Захар', 'Петров', '2006-08-09', 10),
('Иван', 'Лебедев', '2006-09-10', 10),
('Кирилл', 'Михайлов', '2006-10-11', 10),
('Людмила', 'Яковлева', '2006-11-12', 10),
('Мария', 'Павлова', '2006-12-13', 10),
('Николай', 'Макаров', '2006-01-14', 10),
('Ольга', 'Семенова', '2006-02-15', 10),
('Павел', 'Морозов', '2006-03-16', 10),
('Роман', 'Гусев', '2006-04-17', 10),
('Светлана', 'Денисова', '2006-05-18', 10),
('Татьяна', 'Беляева', '2006-06-19', 10),
('Ульяна', 'Климова', '2006-07-20', 10),
('Филипп', 'Воробьев', '2006-08-21', 10);

-- Добавим данные о домашних заданиях
INSERT INTO homework (class_id, teacher_subject_id, due_date, description)
VALUES
(1, 1, '2024-12-01', 'Написать сочинение на тему "Зима"'),
(2, 2, '2024-12-05', 'Решить задачи на странице 50'),
(3, 3, '2024-12-07', 'Прочитать главу 3 "Война и мир"'),
(4, 4, '2024-12-02', 'Подготовить презентацию по теме "Грамматика"'),
(5, 5, '2024-12-10', 'Сделать лабораторную работу №5'),
(6, 6, '2024-12-06', 'Выучить формулы для химических реакций'),
(7, 7, '2024-12-04', 'Написать программу для вычисления суммы чисел'),
(8, 8, '2024-12-12', 'Изучить карту Европы'),
(9, 9, '2024-12-09', 'Подготовить доклад по истории России'),
(10, 10, '2024-12-14', 'Составить тезисы по теме "Гражданское общество"'),
(1, 2, '2024-12-11', 'Решить задачи на странице 60'),
(2, 4, '2024-12-08', 'Выучить слова на тему "Еда"'),
(3, 5, '2024-12-13', 'Сделать лабораторную работу №6'),
(4, 7, '2024-12-03', 'Написать программу для вычисления факториала'),
(5, 8, '2024-12-15', 'Изучить карту Азии'),
(6, 9, '2024-12-16', 'Подготовить презентацию по теме "Вторая мировая война"'),
(7, 10, '2024-12-17', 'Составить план реферата по обществознанию'),
(8, 1, '2024-12-19', 'Написать сочинение на тему "Весна"'),
(9, 3, '2024-12-22', 'Прочитать главу 5 "Мастер и Маргарита"'),
(10, 6, '2024-12-20', 'Сделать отчет по химическим опытам'),
(1, 5, '2024-12-23', 'Сделать контрольную работу по физике'),
(2, 7, '2024-12-21', 'Написать программу для вычисления среднего арифметического'),
(3, 8, '2024-12-24', 'Изучить карту Африки'),
(4, 9, '2024-12-18', 'Подготовить доклад по теме "Революция 1917 года"'),
(5, 1, '2024-12-25', 'Написать сочинение на тему "Лето"'),
(6, 4, '2024-12-26', 'Выучить грамматические правила'),
(7, 3, '2024-12-27', 'Прочитать главу 7 "Анна Каренина"'),
(8, 2, '2024-12-10', 'Решить задачи на странице 70'),
(9, 5, '2024-12-17', 'Сделать лабораторную работу №7'),
(10, 7, '2024-12-11', 'Написать программу для вычисления корня числа');

-- Успеваемость для рандомных учеников из 10А
INSERT INTO student_grades (student_id, teacher_subject_id, date, grade, comment)
VALUES
(197, 1, '2024-09-01', 5, 'Отлично!'),
(197, 2, '2024-09-02', 4, 'Хорошо'),
(197, 3, '2024-09-03', 3, 'Удовлетворительно'),
(197, 4, '2024-09-04', 4, 'Хорошо'),
(197, 5, '2024-09-05', 5, 'Отлично!'),
(197, 6, '2024-09-06', 3, 'Удовлетворительно'),
(197, 7, '2024-09-07', 5, 'Отлично!'),
(197, 8, '2024-09-08', 4, 'Хорошо'),
(197, 9, '2024-09-09', 3, 'Удовлетворительно'),
(197, 10, '2024-09-10', 4, 'Хорошо'),
(197, 1, '2024-09-11', 5, 'Отлично!'),
(197, 2, '2024-09-12', 4, 'Хорошо'),
(197, 3, '2024-09-13', 3, 'Удовлетворительно'),
(197, 4, '2024-09-14', 4, 'Хорошо'),
(197, 5, '2024-09-15', 5, 'Отлично!'),
(197, 6, '2024-09-16', 3, 'Удовлетворительно'),
(197, 7, '2024-09-17', 5, 'Отлично!'),
(197, 8, '2024-09-18', 4, 'Хорошо'),
(197, 9, '2024-09-19', 3, 'Удовлетворительно'),
(197, 10, '2024-09-20', 4, 'Хорошо'),
(184, 1, '2024-09-01', 4, 'Хорошо'),
(184, 2, '2024-09-02', 5, 'Отлично!'),
(184, 3, '2024-09-03', 3, 'Удовлетворительно'),
(184, 4, '2024-09-04', 4, 'Хорошо'),
(184, 5, '2024-09-05', 3, 'Удовлетворительно'),
(184, 6, '2024-09-06', 5, 'Отлично!'),
(184, 7, '2024-09-07', 4, 'Хорошо'),
(184, 8, '2024-09-08', 3, 'Удовлетворительно'),
(184, 9, '2024-09-09', 5, 'Отлично!'),
(184, 10, '2024-09-10', 4, 'Хорошо'),
(184, 1, '2024-09-11', 3, 'Удовлетворительно'),
(184, 2, '2024-09-12', 5, 'Отлично!'),
(184, 3, '2024-09-13', 4, 'Хорошо'),
(184, 4, '2024-09-14', 3, 'Удовлетворительно'),
(184, 5, '2024-09-15', 5, 'Отлично!'),
(184, 6, '2024-09-16', 4, 'Хорошо'),
(184, 7, '2024-09-17', 3, 'Удовлетворительно'),
(184, 8, '2024-09-18', 5, 'Отлично!'),
(184, 9, '2024-09-19', 4, 'Хорошо'),
(184, 10, '2024-09-20', 3, 'Удовлетворительно'),
(200, 1, '2024-09-01', 5, 'Отлично!'),
(200, 2, '2024-09-02', 4, 'Хорошо'),
(200, 3, '2024-09-03', 3, 'Удовлетворительно'),
(200, 4, '2024-09-04', 5, 'Отлично!'),
(200, 5, '2024-09-05', 4, 'Хорошо'),
(200, 6, '2024-09-06', 3, 'Удовлетворительно'),
(200, 7, '2024-09-07', 5, 'Отлично!'),
(200, 8, '2024-09-08', 4, 'Хорошо'),
(200, 9, '2024-09-09', 3, 'Удовлетворительно'),
(200, 10, '2024-09-10', 5, 'Отлично!'),
(200, 1, '2024-09-11', 4, 'Хорошо'),
(200, 2, '2024-09-12', 3, 'Удовлетворительно'),
(200, 3, '2024-09-13', 5, 'Отлично!'),
(200, 4, '2024-09-14', 4, 'Хорошо'),
(200, 5, '2024-09-15', 3, 'Удовлетворительно'),
(200, 6, '2024-09-16', 5, 'Отлично!'),
(200, 7, '2024-09-17', 4, 'Хорошо'),
(200, 8, '2024-09-18', 3, 'Удовлетворительно'),
(200, 9, '2024-09-19', 5, 'Отлично!'),
(200, 10, '2024-09-20', 4, 'Хорошо'),
(192, 1, '2024-09-01', 4, 'Хорошо'),
(192, 2, '2024-09-02', 5, 'Отлично!'),
(192, 3, '2024-09-03', 3, 'Удовлетворительно'),
(192, 4, '2024-09-04', 5, 'Отлично!'),
(192, 5, '2024-09-05', 4, 'Хорошо'),
(192, 6, '2024-09-06', 3, 'Удовлетворительно'),
(192, 7, '2024-09-07', 5, 'Отлично!'),
(192, 8, '2024-09-08', 4, 'Хорошо'),
(192, 9, '2024-09-09', 5, 'Отлично!'),
(192, 10, '2024-09-10', 4, 'Хорошо'),
(192, 1, '2024-09-11', 3, 'Удовлетворительно'),
(192, 2, '2024-09-12', 5, 'Отлично!'),
(192, 3, '2024-09-13', 4, 'Хорошо'),
(192, 4, '2024-09-14', 3, 'Удовлетворительно'),
(192, 5, '2024-09-15', 5, 'Отлично!'),
(192, 6, '2024-09-16', 4, 'Хорошо'),
(192, 7, '2024-09-17', 3, 'Удовлетворительно'),
(192, 8, '2024-09-18', 5, 'Отлично!'),
(203, 1, '2024-09-01', 5, 'Отлично!'),
(203, 2, '2024-09-02', 4, 'Хорошо'),
(203, 3, '2024-09-03', 3, 'Удовлетворительно'),
(203, 4, '2024-09-04', 4, 'Хорошо'),
(203, 5, '2024-09-05', 5, 'Отлично!'),
(203, 6, '2024-09-06', 3, 'Удовлетворительно'),
(203, 7, '2024-09-07', 5, 'Отлично!'),
(203, 8, '2024-09-08', 4, 'Хорошо'),
(203, 9, '2024-09-09', 3, 'Удовлетворительно'),
(203, 10, '2024-09-10', 4, 'Хорошо'),
(203, 1, '2024-09-11', 5, 'Отлично!'),
(203, 2, '2024-09-12', 4, 'Хорошо'),
(203, 3, '2024-09-13', 3, 'Удовлетворительно'),
(203, 4, '2024-09-14', 4, 'Хорошо'),
(203, 5, '2024-09-15', 5, 'Отлично!'),
(203, 6, '2024-09-16', 3, 'Удовлетворительно'),
(203, 7, '2024-09-17', 5, 'Отлично!'),
(203, 8, '2024-09-18', 4, 'Хорошо'),
(203, 9, '2024-09-19', 3, 'Удовлетворительно'),
(203, 10, '2024-09-20', 4, 'Хорошо');

--Найдем количество учеников в каждом классе и выясним, кто является классным руководителем этого класса
SELECT t.first_name, t.last_name, c.class_number, c.class_letter, COUNT(s.student_id) AS num_students
FROM students s
JOIN classes c ON s.class_id = c.class_id
JOIN teachers t ON c.teacher_id = t.teacher_id
GROUP BY c.class_number, c.class_letter, t.first_name, t.last_name
ORDER BY c.class_number, c.class_letter
LIMIT 10;

-- Теперь узнаем среднюю успеваемость учеников 10 класса по предметам
SELECT s.last_name, s.first_name, sub.subject_name AS subject_name, AVG(g.grade) AS average_grade
FROM students s
JOIN classes c ON s.class_id = c.class_id
JOIN student_grades g ON s.student_id = g.student_id
JOIN teacher_subjects ts ON g.teacher_subject_id = ts.teacher_subject_id
JOIN subjects sub ON ts.subject_id = sub.subject_id
WHERE c.class_number = 10
GROUP BY  s.last_name, s.first_name, sub.subject_name
ORDER BY  s.last_name, s.first_name, sub.subject_name
LIMIT 30;

-- Найдем учеников с высоким средним баллом по математике (выше или равно 4)
SELECT s.last_name, s.first_name, AVG(g.grade) AS average_grade
FROM students s
JOIN student_grades g ON s.student_id = g.student_id
JOIN teacher_subjects ts ON g.teacher_subject_id = ts.teacher_subject_id
JOIN  subjects sub ON ts.subject_id = sub.subject_id
WHERE sub.subject_name = 'Математика'
GROUP BY s.last_name, s.first_name
HAVING AVG(g.grade) >= 4
ORDER BY average_grade DESC
LIMIT 5;
